<div class="vt-container">
  <h3>Video Compressor</h3>

  <label>Choose video</label>
  <input type="file" accept="video/*" (change)="onFileSelected($event)" />

  <div *ngIf="selectedFile">
    <p>Selected: {{ selectedFile.name }} ({{ formatSize(selectedFile.size) }})</p>
  </div>

  <div class="settings">
    <label>Target Width (px)</label>
    <input type="number" [(ngModel)]="targetWidth" />
    <label>Target Height (px)</label>
    <input type="number" [(ngModel)]="targetHeight" />
    <label>Frame Rate</label>
    <input type="number" [(ngModel)]="frameRate" />
    <label>Extraction Speed (playbackRate)</label>
    <input type="number" [(ngModel)]="extractionSpeed" />
    <label>Quality (0.1-1)</label>
    <input type="range" min="0.1" max="1" step="0.1" [(ngModel)]="quality" />
    <span>{{ quality }}</span>
  </div>

  <button class="btn" (click)="compressVideo()" [disabled]="processing || !selectedFile">
    {{ processing ? 'Processing...' : 'Start Compression' }}
  </button>

  <div class="progress" *ngIf="processing || progressPercent">
    <div class="progress-bar" [style.width.%]="progressPercent"></div>
    <p>{{ progressText }}</p>
  </div>

  <div *ngIf="frames.length">
    <h4>Extracted frames (sample)</h4>
    <div class="frames">
      @for (f of frames | slice: 0 : 20; track f) {
      <img [src]="f.url" class="frame" />
      }
    </div>
  </div>

  <div *ngIf="outputUrl" class="result">
    <h4>Compressed Video ({{ formatSize(outputSizeBytes!) }})</h4>
    <video [src]="outputUrl" controls width="360"></video>
    <button (click)="downloadResult()">Download</button>
  </div>
</div>
