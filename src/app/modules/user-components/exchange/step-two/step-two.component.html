<form class="bg-background my-4 space-y-3 rounded-2xl px-2 shadow-sm sm:p-8" [formGroup]="formGroup">
  <!-- BASIC INFO -->
  <div class="space-y-6">

    <!-- Name -->
    <div class="form__group">
      <div class="relative">
        <input
          type="text"
          formControlName="Name"
          [ngClass]="{ 'is__invalid-input': common.hasError('Name', 'required', formGroup) }"
          class="focus:border-primary focus:ring-primary/20 peer w-full rounded-xl border border-gray-300 bg-gray-50 px-4 py-3 text-sm focus:ring-2"
          placeholder=" " />
        <label class="floating-label">Full Name</label>
      </div>
      @if (common.hasError('Name','required', formGroup)) {
      <small class="error-text">Name is required</small>
      }
    </div>

    <!-- Email -->
    <div class="form__group">
      <div class="relative">
        <input
          type="email"
          formControlName="Email"
          class="focus:border-primary focus:ring-primary/20 peer w-full rounded-xl border border-gray-300 bg-gray-50 px-4 py-3 text-sm focus:ring-2"
          placeholder=" " />
        <label class="floating-label">Email Address</label>
      </div>
      @if (common.hasError('Email','required', formGroup)) {
      <small class="error-text">Email is required</small>
      } @if (common.hasError('Email','Email', formGroup)) {
      <small class="error-text">Enter a valid email</small>
      }
    </div>

    <!-- Phone -->
    <div class="form__group">
      <div class="relative">
        <input
          type="text"
          formControlName="Phone"
          class="focus:border-primary focus:ring-primary/20 peer w-full rounded-xl border border-gray-300 bg-gray-50 px-4 py-3 text-sm focus:ring-2"
          placeholder=" " />
        <label class="floating-label">Emergency Contact Number</label>
      </div>
      @if (common.hasError('Phone','required', formGroup)) {
      <small class="error-text">Phone is required</small>
      }
    </div>

    <!-- Receiving Details -->
    <div class="form__group">
      <div class="relative">
        <input
          type="text"
          formControlName="UserReceivingDetails"
          class="focus:border-primary focus:ring-primary/20 peer w-full rounded-xl border border-gray-300 bg-gray-50 px-4 py-3 text-sm focus:ring-2"
          placeholder=" " />
        <label class="floating-label">{{ cleanInstruction }}</label>
      </div>
      @if (common.hasError('UserReceivingDetails','required', formGroup)) {
      <small class="error-text">
        {{ exchange.rate()?.ToCurrency?.PaymentInstruction }}
      </small>
      }
    </div>
  </div>

  <!-- BANK DETAILS -->
  @if (exchange.rate()?.ToCurrency?.Name == "Bank Transfer") {
  <div class="space-y-5 rounded-xl border bg-gray-50 p-5">
    <h3 class="text-sm font-semibold uppercase tracking-wide text-gray-600">Bank Details</h3>

    <div class="form__group">
      <input class="input" formControlName="AccountHolderName" placeholder="Account Holder Name" />
    </div>

    <div class="form__group">
      <select class="input" formControlName="BankName">
        @for (item of bankService.bank(); track $index) {
        <option [value]="item.Name">{{ item.Name }}</option>
        }
      </select>
    </div>

    <div class="form__group">
      <input class="input" formControlName="Branch" placeholder="Branch Name" />
    </div>
  </div>
  }

  <!-- TERMS -->
  <div class="flex items-center gap-3 rounded-lg border bg-gray-50 p-4">
    <input type="checkbox" formControlName="AcceptTerm" class="rounded border-gray-300" />
    <span class="text-sm text-gray-600">
      I accept the <span class="text-primary font-semibold">Terms & Conditions</span>
    </span>
  </div>
  @if (common.hasError('AcceptTerm','required', formGroup)) {
  <small class="error-text">You must accept the terms</small>
  }

  <!-- ACTIONS -->
  <div class="flex flex-col gap-3 pt-4 sm:flex-row sm:justify-between">
    <button
      type="button"
      class="rounded-xl bg-gray-200 px-6 py-3 text-sm font-medium text-gray-700 hover:bg-gray-300"
      (click)="back.emit()">
      ← Back
    </button>

    <button
      type="button"
      (click)="onNext()"
      class="bg-primary hover:bg-primary/90 rounded-xl px-8 py-3 text-sm font-semibold text-white shadow">
      Continue →
    </button>
  </div>
</form>
