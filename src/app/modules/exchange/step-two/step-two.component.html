<form class="my-10 space-y-6" [formGroup]="formGroup">
  <!-- Name -->
  <div class="form__group">
    <div class="relative">
      <input
        type="text"
        id="name"
        formControlName="Name"
        [ngClass]="{ 'is__invalid-input': hasError('Name', 'required') }"
        class="bg-background focus:border-primary focus:ring-primary peer block w-full rounded-md border border-gray-300 px-4 py-3 !text-[14px] focus:ring-1"
        placeholder=" " />
      <label
        for="Name"
        [ngClass]="{ 'is__invalid-input': hasError('Name', 'required') }"
        class="bg-background text-muted-foreground peer-focus:text-primary absolute top-2 z-10 origin-[0] -translate-y-4 scale-95 transform px-2 text-sm duration-300 peer-placeholder-shown:top-1/2 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:scale-100 peer-focus:top-2 peer-focus:-translate-y-4 peer-focus:scale-95 peer-focus:px-2">
        Full Name
      </label>
    </div>
    @if (hasError('Name','required')) {
    <small class="mt-1 block text-red-500">Name is required</small>
    }
  </div>

  <!-- Email -->
  <div class="form__group">
    <div class="relative">
      <input
        type="email"
        id="email"
        formControlName="Email"
        [ngClass]="{ 'is__invalid-input': hasError('Email', 'required') || hasError('Email', 'Email') }"
        class="bg-background focus:border-primary focus:ring-primary peer block w-full rounded-md border border-gray-300 px-4 py-3 !text-[14px] focus:ring-1"
        placeholder=" " />
      <label
        for="email"
        [ngClass]="{ 'is__invalid-input': hasError('Email', 'required') || hasError('Email', 'Email') }"
        class="bg-background text-muted-foreground peer-focus:text-primary absolute top-2 z-10 origin-[0] -translate-y-4 scale-95 transform px-2 text-sm duration-300 peer-placeholder-shown:top-1/2 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:scale-100 peer-focus:top-2 peer-focus:-translate-y-4 peer-focus:scale-95 peer-focus:px-2">
        Email Address
      </label>
    </div>
    @if (hasError('Email','required')) {
    <small class="text-red-500">Email is required</small>
    } @if (hasError('Email','Email')) {
    <small class="text-red-500">Enter a valid Email</small>
    }
  </div>

  <!-- Phone -->
  <div class="form__group">
    <div class="relative">
      <input
        type="text"
        id="phone"
        formControlName="Phone"
        [ngClass]="{ 'is__invalid-input': hasError('Phone', 'required') || hasError('Phone', 'pattern') }"
        class="bg-background focus:border-primary focus:ring-primary peer block w-full rounded-md border border-gray-300 px-4 py-3 !text-[14px] focus:ring-1"
        placeholder=" " />
      <label
        for="phone"
        [ngClass]="{ 'is__invalid-input': hasError('Phone', 'required') || hasError('Phone', 'pattern') }"
        class="bg-background text-muted-foreground peer-focus:text-primary absolute top-2 z-10 origin-[0] -translate-y-4 scale-95 transform px-2 text-sm duration-300 peer-placeholder-shown:top-1/2 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:scale-100 peer-focus:top-2 peer-focus:-translate-y-4 peer-focus:scale-95 peer-focus:px-2">
        Phone Number
      </label>
    </div>
    @if (hasError('Phone','required')) {
    <small class="text-red-500">Phone is required</small>
    } @if (hasError('Phone','pattern')) {
    <small class="text-red-500">Phone number is invalid</small>
    }
  </div>

  <!-- UserReceivingDetails ID -->
  <div class="form__group">
    <div class="relative">
      <input
        type="text"
        id="userReceivingDetails"
        formControlName="UserReceivingDetails"
        [ngClass]="{ 'is__invalid-input': hasError('UserReceivingDetails', 'required') }"
        class="bg-background focus:border-primary focus:ring-primary peer block w-full rounded-md border border-gray-300 px-4 py-3 !text-[14px] focus:ring-1"
        placeholder=" " />
      <label
        for="userReceivingDetails"
        [ngClass]="{ 'is__invalid-input': hasError('UserReceivingDetails', 'required') }"
        class="bg-background text-muted-foreground peer-focus:text-primary absolute top-2 z-10 origin-[0] -translate-y-4 scale-95 transform px-2 text-sm duration-300 peer-placeholder-shown:top-1/2 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:scale-100 peer-focus:top-2 peer-focus:-translate-y-4 peer-focus:scale-95 peer-focus:px-2">
        {{ cleanInstruction }}
      </label>
    </div>
    @if (hasError('UserReceivingDetails','required')) {
    <small class="mt-1 block text-red-500">{{ exchangeService.rate()?.ToCurrency?.PaymentInstruction }}</small>
    }
  </div>

  @if (exchangeService.rate()?.ToCurrency?.Name == "Bank Transfer") {
    
  <!-- Branch -->
  <div class="form__group">
    <div class="relative">
      <input
        type="text"
        id="accountHolderName"
        formControlName="AccountHolderName"
        [ngClass]="{ 'is__invalid-input': hasError('AccountHolderName', 'required') || hasError('AccountHolderName', 'pattern') }"
        class="bg-background focus:border-primary focus:ring-primary peer block w-full rounded-md border border-gray-300 px-4 py-3 !text-[14px] focus:ring-1"
        placeholder=" " />
      <label
        for="accountHolderName"
        [ngClass]="{ 'is__invalid-input': hasError('AccountHolderName', 'required') || hasError('AccountHolderName', 'pattern') }"
        class="bg-background text-muted-foreground peer-focus:text-primary absolute top-2 z-10 origin-[0] -translate-y-4 scale-95 transform px-2 text-sm duration-300 peer-placeholder-shown:top-1/2 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:scale-100 peer-focus:top-2 peer-focus:-translate-y-4 peer-focus:scale-95 peer-focus:px-2">
        Account Holder Name
      </label>
    </div>
    @if (hasError('Branch','required')) {
    <small class="text-red-500">Account Holder Name is required</small>
    } @if (hasError('Branch','pattern')) {
    <small class="text-red-500">Accoun Holder Name is invalid</small>
    }
  </div>

  <!-- Bank Name -->
  <div class="form__group">
    <div class="relative">
      <select
        formControlName="BankName"
        class="tbg-background focus:border-primary focus:ring-primary peer block w-full rounded-md border border-gray-300 px-4 py-3 !text-[14px] focus:ring-1"
        (change)="onStatusChange($event)">
        @for (item of bankService.bank(); track $index) {
        <option [value]="item.Id">{{ item.Name }}</option>
        }
      </select>
      <label
        for="bankName"
        [ngClass]="{ 'is__invalid-input': hasError('BankName', 'required') }"
        class="bg-background text-muted-foreground peer-focus:text-primary absolute top-2 z-10 origin-[0] -translate-y-4 scale-95 transform px-2 text-sm duration-300 peer-placeholder-shown:top-1/2 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:scale-100 peer-focus:top-2 peer-focus:-translate-y-4 peer-focus:scale-95 peer-focus:px-2">
        Bank Name
      </label>
    </div>
    @if (hasError('BankName','required')) {
    <small class="mt-1 block text-red-500">{{ exchangeService.rate()?.ToCurrency?.PaymentInstruction }}</small>
    }
  </div>

  <!-- Branch -->
  <div class="form__group">
    <div class="relative">
      <input
        type="text"
        id="branch"
        formControlName="Branch"
        [ngClass]="{ 'is__invalid-input': hasError('Branch', 'required') || hasError('Branch', 'pattern') }"
        class="bg-background focus:border-primary focus:ring-primary peer block w-full rounded-md border border-gray-300 px-4 py-3 !text-[14px] focus:ring-1"
        placeholder=" " />
      <label
        for="branch"
        [ngClass]="{ 'is__invalid-input': hasError('Branch', 'required') || hasError('Branch', 'pattern') }"
        class="bg-background text-muted-foreground peer-focus:text-primary absolute top-2 z-10 origin-[0] -translate-y-4 scale-95 transform px-2 text-sm duration-300 peer-placeholder-shown:top-1/2 peer-placeholder-shown:-translate-y-1/2 peer-placeholder-shown:scale-100 peer-focus:top-2 peer-focus:-translate-y-4 peer-focus:scale-95 peer-focus:px-2">
        Branch Name
      </label>
    </div>
    @if (hasError('Branch','required')) {
    <small class="text-red-500">Branch is required</small>
    } @if (hasError('Branch','pattern')) {
    <small class="text-red-500">Branch number is invalid</small>
    }
  </div>

  }

  <!-- Accept Terms -->
  <div class="flex items-center gap-2">
    <input id="accept-term" type="checkbox" formControlName="AcceptTerm" />
    <label for="accept-term" class="text-muted-foreground text-sm">I Accept the</label>
    <app-button impact="none" tone="primary" shape="rounded" size="small">Terms</app-button>
  </div>
  @if (hasError('AcceptTerm','required')) {
  <small class="mt-1 block text-red-500">You must accept the terms</small>
  }

  <!-- Actions -->
  <div class="mt-4 flex justify-between">
    <button type="button" (click)="back.emit()" class="cursor-pointer rounded bg-gray-300 px-4 py-2">&lt; Back</button>
    <button
      type="button"
      (click)="onNext()"
      [disabled]="formGroup.invalid"
      class="bg-primary cursor-pointer rounded px-4 py-2 text-white disabled:opacity-50">
      Next
    </button>
  </div>
</form>
